Let’s break down what you’re asking:

You want to **ingest an index into Elasticsearch** (i.e., index some documents) such that:

1. The index has **fields** (normal fields you can query).
2. Some fields are **not queriable** (i.e., not searchable or indexed).

Below is a complete example and explanation for both parts.

---

## 🧩 1. Create an index with field mappings

You can control whether fields are *queriable* by setting `"index": false` in the field mapping.

Example — Create an index with both searchable and non-searchable fields:

```bash
PUT my-ingest-index
{
  "mappings": {
    "properties": {
      "user": {
        "type": "keyword"
      },
      "message": {
        "type": "text"
      },
      "raw_payload": {
        "type": "object",
        "enabled": false
      },
      "non_searchable_field": {
        "type": "keyword",
        "index": false
      }
    }
  }
}
```

### Explanation:

* `"user"` and `"message"` → queriable fields.
* `"non_searchable_field"` → stored, but not indexed (cannot be searched or filtered).
* `"raw_payload"` with `"enabled": false` → completely ignored by the indexer (not indexed, not stored, not queriable — but stays in `_source`).

---

## 🧾 2. Ingest documents into this index

```bash
POST my-ingest-index/_doc
{
  "user": "alice",
  "message": "Login successful",
  "non_searchable_field": "internal_tag_001",
  "raw_payload": {
    "session_id": "abc123",
    "ip": "10.0.0.1"
  }
}
```

This will successfully store the document.

---

## 🔍 3. Query behavior

### Searchable field query:

```bash
GET my-ingest-index/_search
{
  "query": {
    "match": {
      "message": "Login"
    }
  }
}
```

✅ Works — `"message"` is indexed.

### Non-searchable field query:

```bash
GET my-ingest-index/_search
{
  "query": {
    "term": {
      "non_searchable_field": "internal_tag_001"
    }
  }
}
```

🚫 Returns no results — `"non_searchable_field"` is not indexed.

---

## 🧠 Summary

| Field                  | Stored in `_source` | Indexed (Queryable) | Can aggregate |
| ---------------------- | ------------------- | ------------------- | ------------- |
| `user`                 | ✅                   | ✅                   | ✅             |
| `message`              | ✅                   | ✅                   | ✅             |
| `non_searchable_field` | ✅                   | ❌                   | ❌             |
| `raw_payload`          | ✅                   | ❌ (not even parsed) | ❌             |

---

Would you like me to show how to do this via **Ingest Pipeline** (e.g., adding or removing fields before indexing)? That’s often used when you want to drop or disable fields dynamically.
